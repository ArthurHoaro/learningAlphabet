<!DOCTYPE html>
<html lang="fr">
<head>
<title> Tri Drag'n'Drop HTML5 </title>
	<link href='http://fonts.googleapis.com/css?family=Audiowide' rel='stylesheet' />
	<link rel="stylesheet" href="libs/jquery.mobile-1.2.0.min.css" />
	
	<script src="libs/jquery-1.8.2.min.js"></script>
	<script src="libs/jquery.mobile-1.2.0.min.js"></script>
	<script src="libs/jquery-ui-1.9.1/js/jquery-ui-1.9.1.custom.min.js"></script>
	<link rel="stylesheet" href="libs/jquery-ui-1.9.1/css/smoothness/jquery-ui-1.9.1.custom.min.css" />
	<!-- Drag and drop pour les mobiles -->
	<script src="libs/jquery.ui.touch-punch.min.js"></script>
	<script src="scripts/random.js"></script>
	<script src="scripts/array.js"></script>
	<meta charset="utf-8" /> 
	<link rel="stylesheet" href="style.css" />
	<script type="text/javascript">
	var nbTourRestant=5;
	var listeLettres;
	function partie(){	
			
			listeLettres = getRandomList(4);
			while(checkOrdreAlpha(true)==true){
				listeLettres=getRandomList(4);
				nbTourRestant++;
			}
			$('#sortable').empty();
			$('#nbTourRestant').html('Nombre de tour restants : '+nbTourRestant);
			for( var i = 0 ; i < listeLettres.length ; ++i ) {
				$('#sortable').append('<li class="lettre">'+ listeLettres[i] +'</li>');
			}
			$('#sortable').listview('refresh');
			//alert(listeLettres.sort());
			$( "#sortable" ).sortable();
		    $( "#sortable" ).disableSelection();
		   // <!-- Refresh list to the end of sort to have a correct display -->
		    $( "#sortable" ).bind( "sortstop", function(event, ui) {
	     		$('#sortable').listview('refresh'); 
	     		 if(checkOrdreAlpha(false) && nbTourRestant>=0){
	     		 	alert('OK');
	     		 	if(nbTourRestant==0){
	     		 		$('#sortable').empty();
	     		 		$('#nbTourRestant').html('Nombre de tour restants : '+nbTourRestant);
	     		 	}
	     		 	else if(nbTourRestant>0){
	     				partie();	     	
	     			}		
	       		}	
		    });
		   

	}
		$(document).ready(function() {	
			partie();
			
		});		

	  	function checkOrdreAlpha(test) {
	  		var curList = new Array();
	  		var i = 0;
	  		if(test){
	  			curList=listeLettres;
	  		}
	  		else{
		  		$('.lettre').each(function() {
		  			curList[i++] = $(this).html();
		  		});
	  		}
	  		var solution = copyArray(curList);
	  		solution.sort();
	  		if (arrayEqual(curList, solution)) {
	  			nbTourRestant--;
	  			return true;
	  		}
	  		else
	  			return false;
	  		
	  	}
	</script>
</head>
<body>

<header data-role="header">
	<h1>Jeu tri</h1>
	<h2 id="nbTourRestant"></h2>	
</header>

<section data-role="content"> 
	<div data-role="content" data-theme="c">
		<ul data-role="listview" data-inset="true" data-theme="d" id="sortable">
			<li data-role="list-divider">Ranger dans l'ordre alphab√©tique</li>
		</ul>
	</div>
</section>
<footer data-role="footer">
	Copyright "IRC" 2012-2013, tous droits reserves.
</footer>
</body>

</html>